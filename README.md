//3_ترکيب فيلتر سرانه خريد و نسبت ها با شروط تکنيکالي(حين بازار)ترکيب بچه جادوگر،اکبروجعفر true==function() { var sum = 0; for(var i =0 ; i<=20 ; i++){ sum = sum + [ih][i].QTotTran5J ; } // mahour haman miangine hajme mahane ast; var mahour = Math.round(sum/21 / 10000 ) / 100; var sum1 = 0; for(var i =0 ; i<=4 ; i++){ sum1 = sum1 + [ih][i].QTotTran5J ; } // panjali haman miangine hajme 5 rooze akhir ast; var panjali = Math.round( sum1/5 / 10000 ) / 100; var EXMA = function (period) { var EMA=[0]; //set ema 0 with sma var sum=0; for (var i = 0; i<=period-2;i++) { sum += [ih][i].PClosing ; } sum+=(pc); EMA[period-2]=sum/period; // calculate k var k = 2 / (period+1 ) ; //calculate other EMA except last_ema for(var i = period-3 ; i >=0;i--) { EMA[i] = ( [ih][i].PClosing - EMA [ i+1 ] ) * k +EMA [ i+1 ] ; } //calculate last_ema var last_ema = ( (pc) - EMA[0] ) * k + EMA[0]; return last_ema; }; // akbar haman macd ast ; // jafar haman rsi ast; //ghodrat haman nesbat ast; // lotfan copy nakonid; var akbar = EXMA(9) - EXMA(26) ; var akbar_khoshgel = Math.round(akbar * 10) / 10 	 var CalculateRSI =function(period){ var len=20; for (var i = 0; i < len ; i++) { var rec=[ih][len-1-i]; var change=rec.PClosing-rec.PriceYesterday; if (change> 0) { rec.gain=change; rec.loss=0; } else { rec.gain=0; rec.loss=-change; } } // Calculate first "average gain" and "average loss" var gainSum=0; var lossSum=0; for (var i = 0; i < period; i++) { var rec=[ih][len-1-i]; gainSum += rec.gain; lossSum += rec.loss; } var averageGain=gainSum /period; var averageLoss=lossSum / period; // Calculate subsequent "average gain" and "average loss" values for (var i = period + 1; i < len; i++) { var rec=[ih][len-1-i]; averageGain=(averageGain* (period - 1) + rec.gain) / period; averageLoss=(averageLoss* (period - 1) + rec. loss)/ period; rec.averageGain=averageGain; rec.averageLoss=averageLoss; } // Calculate RSI var RS = 0; // Relative strength var RSIndex = 0; // Relative strength index for (var i = period + 1; i < len; i++) { var rec=[ih][len-1-i]; RS = rec.averageGain/ rec.averageLoss; RSIndex = 100 - 100 / (1 + RS); rec.rsi=RSIndex; } }; if(typeof [ih][0].rsi=="undefined") CalculateRSI(14); var jafar = [ih][0].rsi; var jafar_khoshgel = Math.round(jafar * 10 ) / 10 	 	 var darsad_kh = (ct).Buy_I_Volume / (tvol) ; var pool_kh = darsad_kh * (tval) ; var sarane_kh = pool_kh / (ct).Buy_CountI ; var sarane_kh_khoshgel = Math.round(sarane_kh / 100000 ) / 100 ; var darsad_f = (ct).Sell_I_Volume / (tvol) ; var pool_f = darsad_f * (tval) ; var sarane_f = pool_f / (ct).Sell_CountI ; var sarane_f_khoshgel = Math.round(sarane_f / 100000 ) / 100 ; var ghodrat = sarane_kh / sarane_f ; var ghodrat_khoshgel = Math.round(ghodrat * 100 ) / 100 ; (cfield1) = "vol5: " + panjali +" , " +"vol20: "+ mahour ; (cfield2) = "gh: " + ghodrat_khoshgel + ", s_kh: " + sarane_kh_khoshgel + ", s_f: " + sarane_f_khoshgel ; (cfield0) = "rsi: "+ jafar_khoshgel +" , "+ "macd: " + akbar_khoshgel ; var sum = [ih][0].QTotTran5J + [ih][1].QTotTran5J + [ih][2].QTotTran5J + [ih][3].QTotTran5J + [ih][4].QTotTran5J ; var panjali = sum / 5 ; //panjali haman miyangine hajme 5 rooze akhir ast // lotfan dar soorate copy kardane code panjali ra taghiir nadahid if ( sarane_kh_khoshgel > 12 && ghodrat_khoshgel > 1.5 && jafar > 60 && akbar > 0 ) { return true; } }() // (cfield0) = ghodrat_khoshgel ; // (cfield1) = sarane_kh_khoshgel ; // (cfield2) = sarane_f_khoshgel ; // (cfield1) = "vol5: " + panjali +" , " +"vol20: "+ mahour ; // (cfield2) = "gh: " + ghodrat_khoshgel + ", s_kh: " + sarane_kh_khoshgel + ", s_f: " + sarane_f_khoshgel ; // (cfield0) = ghodrat_khoshgel ; // (l18).indexOf("???")==0 || (l18).indexOf("???")==0 // ((tvol)>(2*mahour) && (tvol)>(2*panjali)); //(cfield1) = "vol5: " + panjali +" , " +"vol20: "+ mahour ; //(cfield2) = "gh: " + ghodrat_khoshgel + ", s_kh: " + sarane_kh_khoshgel + ", s_f: " + sarane_f_khoshgel ; //(cfield0) = "rsi: "+ jafar_khoshgel +" , "+ "macd: " + akbar_khoshgel ; // &&(ghodrat_khoshgel)>1.5 // &&(qd1)>100000شرط اينکه اردرهاي رديف اول تابلو از عدد خاصي بالاتر باشند // &&(pmax)!= (pl)شرط اينکه سهم پيدا شده صف خريد نباشد
